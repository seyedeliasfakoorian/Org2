name: Config and Scan
run-name: ${{ github.actor }} is Configuring and Scanning ðŸš€
on: [push]
jobs:
  Fix-Heroku-Issues:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository code
        uses: actions/checkout@v4
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      - name: Install Heroku CLI
        run: |
          sudo npm install -g heroku
          heroku plugins:install heroku-builds
      - name: Check Heroku deployment logs
        run: heroku logs --app website-breaker-demo
      - name: Reduce Vulnerabilities
        run: yarn audit
      - name: Deploy to Heroku
        run: heroku login -i
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          branch: github-actions
          commit-message: Fix Heroku Vulnerabilities
          delete-branch: true
          labels: |
           github actions
          reviewers: seyedeliasfakoorian
          title: Fix Heroku Vulnerabilities
          body: |
            This pull request can fix vulnerabilities when Heroku has an issue deploying or needs to check logsðŸš€
            ðŸŒŽ [View Site](https://website-breaker-demo-2e92fbab7def.herokuapp.com/)
      - name: Renovate
        uses: renovate/renovate-action@v30
        with:
          # Add any necessary configuration options for Renovate
          token: ${{ secrets.GITHUB_TOKEN }}
          config: |
            {
              "$schema": "https://docs.renovatebot.com/renovate-schema.json",
              "extends": ["config:base", ":fileOnly"],
              "fileMatch": ["index.php", "styles.css"],
              "onboarding": false,
              "autodiscover": true,
              "platform": "github",
              "logLevel": "debug",
              "autoland": false,
              "autodiscoverPaths": ["index.php", "styles.css"],
              "createPullRequest": true,
              "createPullRequestLabel": "github actions",
              "createPullRequestLabelAssignees": ["seyedeliasfakoorian"],
              "createPullRequestTitle": "Fix Heroku Vulnerabilities",
              "createPullRequestBody": "This pull request can fix vulnerabilities when Heroku has an issue deploying or needs to check logsðŸš€\nðŸŒŽ [View Site](https://website-breaker-demo-2e92fbab7def.herokuapp.com/)",
              "createPullRequestDeleteBranch": true,
              "onError": ["createPullRequest"]
            }